<form [formGroup]="ownerForm" (ngSubmit)="CreateOwner(ownerForm.value)">
  <div class="block">
    <h2 *ngIf="!group">Create a custom group</h2>
    <h2 *ngIf="group">Edit group</h2>
    <mat-form-field class="full-width">
      <input
        matInput
        placeholder="Group name"
        [(ngModel)]="groupName"
        formControlName="groupName"
      />
      <mat-hint align="end">Group name is required.</mat-hint>
      <mat-error *ngIf="HasError('groupName', 'required')"
        >Group name is required.</mat-error
      >
    </mat-form-field>
    <mat-grid-list cols="10" rowHeight="100px" class="panel-body">
      <mat-grid-tile [colspan]="8">
        <app-event-dialog-userpicker
          class="full-width"
          (ListenChildComponentEvent)="notifyMessage($event)"
          [formGroup]="ownerForm"
          formControlName="userInputPicker"
          pickupTitle="Input user or office 365 group"
          [participantList] ="eventUsers"
        ></app-event-dialog-userpicker>
      </mat-grid-tile>
      <mat-grid-tile>
        <button mat-flat-button color="primary" (click)="AddUserToTable()">
          Add
        </button>
      </mat-grid-tile>
    </mat-grid-list>
    <table mat-table [dataSource]="eventUsers">
      <ng-container matColumnDef="avatar">
        <th mat-header-cell *matHeaderCellDef>Avatar</th>
        <td mat-cell *matCellDef="let element">
          <div class="avatar-padding">
            <img
              id="avatar"
              class="make-circle-avatar"
              src="{{ apiUrl }}api/SPUser/GetAvatar?Id={{
                element.Id
              }}&avatarName={{ element.Name }}"
            />
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>User/Group</th>
        <td mat-cell *matCellDef="let element">{{ element.Name }}</td>
      </ng-container>

      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email</th>
        <td mat-cell *matCellDef="let element">{{ element.Email }}</td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>Delete</th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button (click)="DeleteUserInTable(element.Name)">
            <i class="material-icons">delete</i>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    <div class="group-action">
      <button
        mat-raised-button
        color="primary"
        class="add-group-action"
        (click)="removeDuplicateUserAndSave()"
        [disabled]="!ownerForm.valid"
      >
        Save
      </button>
      <button
        mat-raised-button
        class="remove-group-action"
        (click)="closeDrawer()"
      >
        Close
      </button>
    </div>
  </div>
</form>
